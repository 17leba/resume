!function(){var a=0,b=[],c={checkType:function(a){return this.isArray(a)||this.isObject(a)?!0:!1},isArray:function(a){return Array.isArray(a)||"[object Array]"===toString.call(a)},isObject:function(a){return"[object Object]"===toString.call(a)}},d={progress:0,init:function(d,e){if(!c.checkType(d))return alert("载入资源格式为数组或者对象！"),!1;if(c.isArray(d)){for(var f=d.length,g=0;f>g;g++)a+=d[g].length;b=d}if(c.isObject(d))for(var g in d)a+=d[g].length,b.push(d[g]);this.loadMain(b,e)},loadMain:function(b,c){function d(){var b=new XMLHttpRequest||new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){if(4===b.readyState)if(200===b.status)e.dealXmlHttp(b),i++,i<g.length&&d(),e.progress=(h+i)/a,e.showProgressBar(e.progress,g[i-1]),i===g.length&&c();else{if(j++,3===j)return!1;d()}},b.open("GET",g[i],!0),b.setRequestHeader("Content-Type","application/json"),b.send(null)}var e=this,f=b[0],g=b[1],h=0,i=0,j=0,k=function(){var b=new Image;b.src=f[h],b.onload=function(){b.complete===!0&&(Config.imgSource.push(b),h++,h<f.length&&k(),e.progress=h/a,e.showProgressBar(e.progress,f[h-1]),h===f.length&&d())},b.error=function(){h++,k(),e.progress=parseFloat(h/a).toFixed(2),e.showProgressBar(e.progress,f[h-1])}};k()},dealXmlHttp:function(a){var b=JSON.parse(a.responseText),c=b.meta.image.replace(/(.png|.jpeg|.jpg|.gif)$/i,"");Config.jsonObj[c]=b.frames},showProgressBar:function(a){var a=(Config.progressBarW,Config.progressBarH,Config.progressRadius,canvas.width,canvas.height,parseInt(100*a));document.getElementById("load-precent").style.width=500*a/100+"px",document.getElementById("load-precent-nums").innerHTML=a+"%"},showPrecentNums:function(a){document.getElementById("load-precent-nums").innerHTML=a+"%"}};window.loadSources=d}();